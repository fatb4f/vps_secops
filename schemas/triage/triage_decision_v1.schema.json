{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "urn:vpssecops:schema:triage_decision_v1.schema",
  "title": "TriageDecisionV1",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "schema_version",
    "decision",
    "confidence",
    "rule_id",
    "policy_version",
    "evidence_refs",
    "recommended_next_action"
  ],
  "properties": {
    "schema_version": {
      "const": "triage_decision_v1"
    },
    "decision": {
      "type": "string",
      "enum": [
        "close_as_noise",
        "monitor",
        "promote_to_agent",
        "promote_and_respond"
      ]
    },
    "confidence": {
      "type": "number",
      "minimum": 0,
      "maximum": 1
    },
    "rule_id": {
      "type": "string"
    },
    "policy_version": {
      "type": "string"
    },
    "iocs": {
      "type": "array",
      "items": {
        "type": "object",
        "additionalProperties": false,
        "required": [
          "type",
          "value"
        ],
        "properties": {
          "type": {
            "type": "string",
            "enum": [
              "domain",
              "ip",
              "hash",
              "path",
              "process",
              "user"
            ]
          },
          "value": {
            "type": "string"
          }
        }
      }
    },
    "evidence_refs": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "minItems": 1
    },
    "recommended_next_action": {
      "type": "string",
      "enum": [
        "none",
        "run_enrichment_sweep",
        "open_incident",
        "run_safe_response"
      ]
    },
    "notes": {
      "type": "string"
    }
  }
}
